<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Index</title>
  <meta name="generator" content="Google Web Designer 5.0.3.0130">
  <style type="text/css" id="gwd-text-style">
    p {
      margin: 0px;
    }
    h1 {
      margin: 0px;
    }
    h2 {
      margin: 0px;
    }
    h3 {
      margin: 0px;
    }
  </style>
  <style type="text/css">
    html, body {
      width: 100%;
      height: 100%;
      margin: 0px;
    }
    body {
      background-color: transparent;
      transform: perspective(1400px) matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);
      transform-style: preserve-3d;
    }
    .gwd-p-1do4 {
      height: auto;
      left: 0px;
      position: relative;
      top: 0px;
      width: auto;
      background-image: none;
      background-color: transparent;
    }
    .gwd-p-izlo {
      height: auto;
      left: 0px;
      position: relative;
      top: 0px;
      width: auto;
    }
    .gwd-button-39lq {
      color: red;
      float: right;
      width: 80px;
      height: 40px;
      left: 20px;
    }
    .gwd-button-11u5 {
      width: 80px;
      left: 0px;
      height: 30px;
      top: 20px;
    }
    .gwd-button-k5iy {
      width: 80px;
      height: 30px;
      left: -3px;
      top: 20px;
    }
    .gwd-button-cx08 {
      width: 80px;
      left: 0px;
      height: 30px;
      top: 6px;
    }
    .gwd-button-it82 {
      width: 80px;
      height: 30px;
      top: 5px;
      left: 0px;
    }
    .gwd-div-1w7a {
      position: absolute;
      top: 0%;
      left: 0%;
      width: 100%;
      height: 8%;
    }
    .menu {
      margin: auto;
      top: 0%;
      width: 320px;
      height: 30px;
    }
    .gwd-div-2qgl {
      position: absolute;
      margin: auto;
      text-align: center;
      overflow: auto;
      top: 8%;
      height: 750px;
      width: 100%;
    }
    .about {
      text-align: left;
      position: relative;
      margin: auto;
      width: 1200px;
    }
    .cent {
      text-align: left;
      position: relative;
      margin: auto;
      width: 1300px;
    }
    .cent_c {
      text-align: left;
      position: relative;
      margin: auto;
      width: 1000px;
    }
    .gwd-label-p0hn {
      position: absolute;
      width: 2px;
      height: 1px;
      left: 61px;
      top: 30px;
    }
    .gwd-select-1f3m {
      left: 25%;
      top: 2%;
      height: 40%;
      width: 10%;
    }
    .column {
      float: left;
      height: 680px;
      width: 440px;
      text-align: center;
    }
    .column_1 {
      width: 840px;
      height: 680px;
      float: right;
      text-align: center;
    }
    .row {
      height: 170px;
      content: "";
      clear: both;
    }
  </style>
  <script type="text/javascript" gwd-events="support" src="gwd-events-support.1.0.js"></script>
  <script type="text/javascript" gwd-events="handlers">
    window.gwd = window.gwd || {};
    var sort_update;
    var update_history;
    var build_history;
    var active_window = 0;
    var H_offset = 0;
    var old_H_offset = 0;
    var xhr;
    gwd.about = function(event) {
      var x = document.getElementById("cent_c");
      x.style.display = "none";
      x = document.getElementById("canvas_area_1");
      x.style.display = "none";
      x = document.getElementById("about");
      x.style.display = "block";
      active_window = 2;
    };
    gwd.current = function(event) {
      // current data
      var x = document.getElementById("cent_c");
      x.style.display = "block";
      x = document.getElementById("canvas_area_1");
      x.style.display = "none";
      x = document.getElementById("about");
      x.style.display = "none";
      active_window = 0;
      sort_update();
    };
    gwd.history = function(event) {
      // show history
      x = document.getElementById("cent_c");
      x.style.display = "none";
      x = document.getElementById("canvas_area_1");
      x.style.display = "block";
      x = document.getElementById("about");
      x.style.display = "none";
      active_window = 1;
      sort_update();
    };
    gwd.duration_change = function(event) {
      // update graph
      sel = document.getElementById("duration").value;
      build_history();
    };
    gwd.c_b_click = function(event) {
      // click 
      old_H_offset = H_offset;
      H_offset += 1;
      H_offset = H_offset % 5;
      build_history(0, 0, 0);
    };
    gwd.c_c_click = function(event) {
      //click
      old_H_offset = H_offset;
      H_offset += 2;
      H_offset = H_offset % 5;
      build_history(0, 0, 0);
    };
    gwd.c_d_click = function(event) {
      //click
      old_H_offset = H_offset;
      H_offset += 3;
      H_offset = H_offset % 5;
      build_history(0, 0, 0);
    };
    gwd.c_e_click = function(event) {
      //click
      old_H_offset = H_offset;
      H_offset += 4;
      H_offset = H_offset % 5;
      build_history(0, 0, 0);
    };
  </script>
  <script type="text/javascript" gwd-events="registration">
    // Support code for event handling in Google Web Designer
     // This script block is auto-generated. Please do not edit!
    gwd.actions.events.registerEventHandlers = function(event) {
      gwd.actions.events.addHandler('Btn_4', 'click', gwd.about, false);
      gwd.actions.events.addHandler('Btn_1', 'click', gwd.current, false);
      gwd.actions.events.addHandler('Btn_2', 'click', gwd.history, false);
      gwd.actions.events.addHandler('duration', 'change', gwd.duration_change, false);
      gwd.actions.events.addHandler('canvas_b', 'click', gwd.c_b_click, false);
      gwd.actions.events.addHandler('canvas_c', 'click', gwd.c_c_click, false);
      gwd.actions.events.addHandler('canvas_d', 'click', gwd.c_d_click, false);
      gwd.actions.events.addHandler('canvas_e', 'click', gwd.c_e_click, false);
    };
    gwd.actions.events.deregisterEventHandlers = function(event) {
      gwd.actions.events.removeHandler('Btn_4', 'click', gwd.about, false);
      gwd.actions.events.removeHandler('Btn_1', 'click', gwd.current, false);
      gwd.actions.events.removeHandler('Btn_2', 'click', gwd.history, false);
      gwd.actions.events.removeHandler('duration', 'change', gwd.duration_change, false);
      gwd.actions.events.removeHandler('canvas_b', 'click', gwd.c_b_click, false);
      gwd.actions.events.removeHandler('canvas_c', 'click', gwd.c_c_click, false);
      gwd.actions.events.removeHandler('canvas_d', 'click', gwd.c_d_click, false);
      gwd.actions.events.removeHandler('canvas_e', 'click', gwd.c_e_click, false);
    };
    document.addEventListener("DOMContentLoaded", gwd.actions.events.registerEventHandlers);
    document.addEventListener("unload", gwd.actions.events.deregisterEventHandlers);
  </script>
</head>

<body class="htmlNoPages">
  <script type="text/javascript">
    window.onload = function() {
      var t_col = "#F07C60";
      var h_col = "#8CC8E8";
      var r_col = "#A3CDA8";
      var p_col = "#BDBBB3";
      var w_col = "#AD9CF3";
      var peak_col = "#ff0000";
      var sel;
      var PI = 3.1416;
      var rad = 57.2958;
      var marker = 0;
      var c = document.getElementById("canvas");
      var dia = 80;
      var dia_small = 70;
      var chart = [document.getElementById('canvas_a').getContext('2d'),
        document.getElementById('canvas_b').getContext('2d'),
        document.getElementById('canvas_c').getContext('2d'),
        document.getElementById('canvas_d').getContext('2d'),
        document.getElementById('canvas_e').getContext('2d')
      ];

      var titles = ['Temperature', '', ' Humidity  ', '', ' Pressure  ', ' Wind Speed ', '', ' Rain Fall '];
      var plot = ['Min', 'Max', 'Min', 'Max', 'Min', 'Max', 'Mean', 'Gust', 'Total', 'Last Hour'];
      var axis_x_label = ['Minutes', 'Hours', 'Day of Week', 'Day of Month', 'Week of Year'];
      var axis_y_label = ['C', '', '%', '', 'mB', 'mph', '', 'mm'];
      var myarr;
      var m_m_arr;
      const s_label = ["12", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"];

      function draw_dial(loc, win) {
        var x1, y1;
        var ident;
        var scale = 5,
          start = -20;
        var text = "";
        win.textAlign = "center";
        win.fillStyle = "Black";
        win.font = "14px Arial";
        switch (loc) {
          case 0:
            x1 = 166;
            y1 = 133;
            ident = 13;
            scale = 5;
            start = -20;
            text = "Outside Temperature ( C )";
            break;
          case 1:
            x1 = 832;
            y1 = 133;
            ident = 13;
            scale = 5;
            start = -20;
            text = "Inside Temperature ( C )";
            break;
          case 2:
            x1 = 166;
            y1 = 383;
            ident = 11;
            scale = 10;
            start = 0;
            text = "Outside Humidity ( % )";
            break;
          case 3:
            x1 = 832;
            y1 = 383;
            ident = 11;
            scale = 10;
            start = 0;
            text = "Inside Humidity ( % )";
            break;
          case 4:
            x1 = 500;
            y1 = 133;
            ident = 11;
            scale = 20;
            start = 860;

            text = "Air Pressure ( mb )";
            break;
          case 5:
            x1 = 166;
            y1 = 633;
            ident = 11;
            scale = 5;
            start = 0;
            text = "Wind Speed ( mph )";
            break;
        }
        var step = 240 / (ident - 1);
        var offset = dia * 0.707;
        win.beginPath();
        win.arc(x1, y1, dia, 0.75 * PI, 0.25 * PI);
        win.stroke();
        win.beginPath();
        win.moveTo(x1 - offset, y1 + offset);
        win.lineTo(x1 + offset, y1 + offset);
        win.stroke();
        var val;
        for (var i = 0; i < ident; i++) {
          var x2, y2, x3, y3;
          var ang = (-30 + (step * i)) / rad;
          y2 = y1 - ((dia + 2) * Math.sin(ang));
          y3 = y1 - ((dia + 10) * Math.sin(ang));
          x2 = x1 - ((dia + 2) * Math.cos(ang));
          x3 = x1 - ((dia + 10) * Math.cos(ang));
          win.beginPath();
          win.moveTo(x2, y2);
          win.lineTo(x3, y3);
          win.stroke();
          val = (i * scale) + start;
          y2 = y1 + 5 - ((dia + 25) * Math.sin(ang));
          x2 = x1 - ((dia + 25) * Math.cos(ang));


          win.fillText(val.toString(), x2, y2);

        }

        win.fillText(text, x1, y1 + 80);
      }


      function draw_bearing(x, y, win) {
        var ident = 8;
        var direction = ["N", "NE", "E", "SE", "S", "SW", "W", "NW"];
        win.beginPath();
        win.arc(x, y, dia_small, 0, 2 * PI);
        win.stroke();
        win.beginPath();
        win.textAlign = "center";
        win.fillStyle = "Black";
        win.font = "14px Arial";
        var step = 360 / ident;
        for (var i = 0; i < ident; i++) {
          var x2, y2, x3, y3;
          var ang = (90 + (step * i)) / rad;
          y2 = y - ((dia_small + 2) * Math.sin(ang));
          y3 = y - ((dia_small + 10) * Math.sin(ang));
          x2 = ((dia_small + 2) * Math.cos(ang)) + x;
          x3 = ((dia_small + 10) * Math.cos(ang)) + x;
          win.beginPath();
          win.moveTo(x2, y2);
          win.lineTo(x3, y3);
          win.stroke();

          val = (i * 30);
          y2 = y + 5 - ((dia_small + 25) * Math.sin(ang));
          x2 = x - ((dia_small + 25) * Math.cos(ang));
          win.fillText(direction[i], x2, y2);
        }

        text = "Wind Bearing ( mph )";
        win.fillText(text, x, y + 120);
      }

      function data_plot(x, y, win) {
        var delta;
        var dia1 = 80;
        var x1, y1;
        var peak = false;
        switch (x) {
          case 0:
            delta = (1.1667 - (((20 + y) / 90) * 2)) * PI;
            x1 = 166;
            y1 = 133;
            break;
          case 1:
            delta = (1.1667 - (((20 + y) / 90) * 2)) * PI;
            x1 = 832;
            y1 = 133;
            break;
          case 2:
            delta = (1.1667 - ((y / 150) * 2)) * PI;
            x1 = 166;
            y1 = 383;
            break;
          case 3:
            delta = (1.1667 - ((y / 150) * 2)) * PI;
            x1 = 832;
            y1 = 383;
            break;
          case 4:
            delta = (1.1667 - (((y - 860) / 300) * 2)) * PI;
            x1 = 500;
            y1 = 133;
            break;
          case 5:
            delta = (1.1667 - ((y / 75) * 2)) * PI;
            x1 = 166;
            y1 = 633;
            break;
          case 6:
            delta = (0.5 - ((y / 360) * 2)) * PI;
            x1 = 832;
            y1 = 620;
            dia1 = 70;
            break;
          case 7:
            delta = (1.1667 - ((y / 75) * 2)) * PI;
            x1 = 166;
            y1 = 633;
            peak = true;
            break;
        }
        var x2, y2, x3, y3, x4, y4;
        if (peak) {
          y2 = y1 - ((dia1 - 10) * Math.sin(delta + 0.075));
          y3 = y1 - (dia1 * Math.sin(delta));
          y4 = y1 - ((dia1 - 10) * Math.sin(delta - 0.075));
          x2 = ((dia1 - 10) * Math.cos(delta + 0.075)) + x1;
          x3 = (dia1 * Math.cos(delta)) + x1;
          x4 = ((dia1 - 10) * Math.cos(delta - 0.075)) + x1;

          win.beginPath();
          win.fillStyle = peak_col;
          win.moveTo(x2, y2);
          win.lineTo(x3, y3);
          win.lineTo(x4, y4);
          win.lineTo(x2, y2);
          win.fill();

          win.fillText(y, x1, y1 + 50);


        } else {

          y2 = y1 - ((dia1 - 10) * Math.sin(delta + 0.075));
          y3 = y1 - (dia1 * Math.sin(delta));
          y4 = y1 - ((dia1 - 10) * Math.sin(delta - 0.075));
          x2 = ((dia1 - 10) * Math.cos(delta + 0.075)) + x1;
          x3 = (dia1 * Math.cos(delta)) + x1;
          x4 = ((dia1 - 10) * Math.cos(delta - 0.075)) + x1;

          win.beginPath();
          win.moveTo(x2, y2);
          win.lineTo(x3, y3);
          win.lineTo(x4, y4);
          win.lineTo(x2, y2);
          win.fill();
          if (x != 6) win.fillText(y, x1, y1 + 30);
        }
      }

      function draw_rain(win) {
        win.rect(449, 280, 52, 152);
        win.rect(501, 280, 52, 152);
        win.stroke();
        win.beginPath();
        win.textAlign = "center";
        win.fillStyle = "Black";
        win.font = "14px Arial";
        win.fillText(" now ", 360, 355);
        win.fillText("this", 630, 355);
        win.fillText(" hr ", 630, 370);
        win.fillText("Rain Fall ( mm/h )", 500, 463);
      }

      function rain_plot(now, total, win) {
        now /= 2.5;
        total /= 150;
        var n_scale = Math.ceil(now + 0.5);
        var t_scale = Math.ceil(total + 0.5);
        var n_s = 145 * (now / n_scale);
        var n_t = 145 * (total / t_scale);
        var n_ticks;
        if (n_scale < 2) {
          n_ticks = 0.2;
          ticks = 152 / Math.floor(n_scale / 0.2);
        } else
        if (n_scale < 5) {
          n_ticks = 0.5;
          ticks = 152 / Math.floor(n_scale / 0.5);
        } else
        if (n_scale < 20) {
          n_ticks = 2;
          ticks = 152 / Math.floor(n_scale / 2);
        } else {
          n_ticks = 5;
          ticks = 152 / Math.floor(n_scale / 5);
        }
        var s = 0;
        var num = s.toFixed(1);
        var y = 432;
        do {
          win.beginPath();
          win.moveTo(444, y);
          win.lineTo(449, y);
          win.stroke();
          win.fillText(num, 415, y + 5);
          y -= ticks;
          s += n_ticks;
          num = s.toFixed(1);
        } while (s <= n_scale);

        if (t_scale < 2) {
          n_ticks = 0.2;
          ticks = 152 / Math.floor(t_scale / 0.2);
        } else
        if (t_scale < 5) {
          n_ticks = 0.5;
          ticks = 152 / Math.floor(t_scale / 0.5);
        } else
        if (t_scale < 20) {
          n_ticks = 2;
          ticks = 152 / Math.floor(t_scale / 2);
        } else {
          n_ticks = 5;
          ticks = 152 / Math.floor(t_scale / 5);
        }
        s = 0;
        num = s.toFixed(1);
        var y = 432;
        do {
          win.beginPath();
          win.moveTo(553, y);
          win.lineTo(558, y);
          win.stroke();
          win.fillText(num, 580, y + 5);
          y -= ticks;
          s += n_ticks;
          num = s.toFixed(1);
        } while (s <= t_scale);
        win.beginPath();
        win.fillStyle = h_col;
        win.rect(450, 432 - n_s, 50, n_s);
        win.fill();
        win.beginPath();
        win.fillStyle = "Blue";
        win.rect(502, 432 - n_t, 50, n_t);
        win.fill();
      }

      function drawHand(win, pos, length, width) {
        win.beginPath();
        win.lineWidth = width;
        win.lineCap = "round";
        win.moveTo(500, 633);
        var x = Math.sin(pos / rad) * length;
        var y = Math.cos(pos / rad) * length;
        win.lineTo(500 + x, 633 - y);
        win.stroke();
      }

      function clock(win) {
        var step = 30;
        var cc = 633;
        win.beginPath();
        win.arc(500, cc, dia, 0, 2 * PI);
        win.stroke();
        for (var i = 1; i <= 12; i++) {
          var x2, y2, x3, y3;
          var ang = (90 + (step * i)) / rad;
          y2 = cc - ((dia) * Math.sin(ang));
          y3 = cc - ((dia - 5) * Math.sin(ang));
          x2 = ((dia) * Math.cos(ang)) + 500;
          x3 = ((dia - 5) * Math.cos(ang)) + 500;
          win.beginPath();
          win.moveTo(x2, y2);
          win.lineTo(x3, y3);
          win.stroke();

          val = (i * 30);
          y2 = cc + 5 - ((dia + 10) * Math.sin(ang));
          x2 = 500 - ((dia + 10) * Math.cos(ang));
          win.fillText(i, x2, y2);
        }
        var d, h, m;
        d = new Date();
        h = d.getHours();
        m = d.getMinutes();
        h = h % 12;
        //hour
        h = ((h / 12) * 360) + ((m / 60) * 30);
        drawHand(win, h, dia * 0.5, 4);
        //minute
        m = (m / 60) * 360;
        drawHand(win, m, dia * 0.8, 2);
        win.lineWidth = 1;
      }


      function update_fields() {
        xhr = new XMLHttpRequest();
        var a = '0';
        var url = "https://script.google.com/macros/s/AKfycbzep_6TONHLbfjt1H23_iCb0DMc126LPo3smsun/exec?read=current";
        xhr.onreadystatechange = function() {
          if (xhr.readyState == 4) {
            var t_r = xhr.responseText;
            var dat = t_r.split(",");
            var x = document.getElementById("cent_c");
            x.style.display = "block";
            x = document.getElementById("canvas_area_1");
            x.style.display = "none";
            x = document.getElementById("about");
            x.style.display = "none";
            var ctx = c.getContext("2d");
            ctx.fillStyle = t_col;
            ctx.fillRect(0, 0, 333, 250);
            ctx.fillRect(666, 0, 333, 250);
            ctx.fillStyle = h_col;
            ctx.fillRect(0, 250, 333, 250);
            ctx.fillRect(666, 250, 333, 250);
            ctx.fillStyle = p_col;
            ctx.fillRect(333, 0, 333, 250);
            ctx.fillStyle = r_col;
            ctx.fillRect(333, 250, 333, 250);
            ctx.fillStyle = w_col;
            ctx.fillRect(0, 500, 333, 250);
            ctx.fillRect(666, 500, 333, 250);
            ctx.fillStyle = p_col;
            ctx.fillRect(333, 500, 333, 250);
            draw_dial(0, ctx);
            draw_dial(1, ctx);
            draw_dial(2, ctx);
            draw_dial(3, ctx);
            draw_dial(4, ctx);
            draw_dial(5, ctx);
            draw_bearing(832, 620, ctx);
            draw_rain(ctx);

            clock(ctx);

            ctx.fillStyle = "Black";
            data_plot(0, parseFloat(dat[1]), ctx);
            data_plot(1, parseFloat(dat[19]), ctx);
            if (parseFloat(dat[4]) > 100)
              data_plot(2, parseFloat("100"), ctx);
            else
              data_plot(2, parseFloat(dat[4]), ctx);
            if (parseFloat(dat[22]) > 100)
              data_plot(3, parseFloat("100"), ctx);
            else
              data_plot(3, parseFloat(dat[22]), ctx);
            data_plot(4, parseFloat(dat[25]), ctx);
            data_plot(5, parseFloat("10"), ctx);
            data_plot(6, parseFloat("90"), ctx);
            data_plot(7, parseFloat("15"), ctx);
            rain_plot(parseFloat(dat[16]), parseFloat(dat[17]), ctx);

            var x = document.getElementById("cent_c");
            x.style.display = "block";

          }
        };
        xhr.open("GET", url);
        xhr.send(null);
      }

      function draw_graph(num, range, max, ticks, points, t_index) {
        var ctx = chart[num];
        ctx.font = "10px Arial";
        ctx.clearRect(0, 0, 800, 800);
        var y_inc = range / 4;
        var x = 60;
        var y = 30;
        var w = 340;
        var h = 100;
        var ys = 100 / 4;
        var steps = 4;
        var x_step = Math.round(points / ticks);
        if (num === 0) {
          w = 740;
          h = 600;
          steps = 8;
          y_inc = range / 8;
          ys = h / 8;
        };
        ctx.lineWidth = 1;
        ctx.strokeStyle = "grey";
        ctx.rect(x, y, w, h);
        ctx.stroke();

        ctx.textAlign = "center";
        var xl = x;
        var xs = w / ticks;
        var c_b = y + h;
        var i = 0;
        ctx.beginPath();
        do {
          ctx.fillText(i, xl, y + h + 10);
          xl += xs;
          ctx.moveTo(xl, y);
          ctx.lineTo(xl, c_b);
          i += x_step;
        } while (xl < w + x - 1);
        ctx.fillText(i, xl, y + h + 10);
        ctx.stroke();
        var yl = y;
        c_b = x + w;
        ctx.beginPath();
        i = max;
        var step = range / steps;
        do {
          ctx.fillText(i, 45, yl);
          yl += ys;
          ctx.moveTo(x, yl);
          ctx.lineTo(c_b, yl);
          i -= step;
        } while (yl < h + y - 1);
        ctx.fillText(i, 45, yl);
        ctx.stroke();
        ctx.font = "13px Arial";
        ctx.fillText(axis_y_label[t_index], 18, y + (h / 2));
        ctx.fillText(titles[t_index], x + (w / 2), 17);
        ctx.fillText(sel, x + (w / 2), yl + 25);

        ctx.font = "10px Arial";
      }

      build_history = function(data_valid, data_set) {
        var h_c = H_offset;
        var o_h_c = old_H_offset;
        var temp = new Array();
        var min = 0;
        var max = 1;
        var ticks = 30;
        var points = 60;
        sel = document.getElementById("duration").value;
        if (data_valid === 1) {
          switch (sel) {
            case "hour":
              ticks = 15;
              points = 60;
              break;
            case "day":
              ticks = 23;
              points = 23;
              break;
            case "Feb":
              ticks = 28;
              points = 28;
              break;
            case "Apr":
              ticks = 30;
              points = 30;
              break;
            case "Jun":
              ticks = 30;
              points = 30;
              break;
            case "Sep":
              ticks = 30;
              points = 30;
              break;
            case "Nov":
              ticks = 30;
              points = 30;
              break;
            default:
              ticks = 31;
              points = 31;
              break;
          }
        }
        var plots = 0;
        var range = 0;
        var d_set = h_c;
        if (data_valid === 0) {
          do {
            min = -1;
            max = 1;
            range = 2
            draw_graph(plots, range, max, ticks, points, 0);
            plots++;
          } while (plots < 5);
        } else {
          do {
            min = m_m_arr[0][d_set];
            max = m_m_arr[1][d_set];
            range = Math.ceil((max - min) / 2) * 2;
            draw_graph(plots, range, max, ticks, points, d_set);
            temp = new Array();
            temp = myarr[d_set];
            fill_chart(0, plots, temp, range, max, points);
            if ((d_set === 0) || (d_set === 2) || (d_set === 5)) {
              d_set++;
              temp = new Array();
              temp = myarr[d_set];
              fill_chart(1, plots, temp, range, max, points);
            }
            d_set++;
            if (d_set === 8) d_set = 0;
            plots++;
          } while (plots < 5);
        }
      }

      function fill_chart(col, c_num, p_data, range, max, p) {
        var ctx = chart[c_num];
        var x = 60;
        var y = 30;
        var w = 340;
        var h = 100;
        if (c_num === 0) {
          w = 740;
          h = 600;
        };
        if (col === 0) ctx.strokeStyle = "blue";
        if (col === 1) ctx.strokeStyle = "red";
        if (col === 2) ctx.strokeStyle = "green";
        var y_inc = h / range;

        var i = max;
        var s = 0;
        var y1 = 0;
        var xs = w / p;
        var xm = x + (xs * marker);
        var hm = y + h;
        y1 = y + (y_inc * (i - p_data[0]));
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(x, y1);
        do {
          s++;
          x += xs;
          y1 = y + (y_inc * (i - p_data[s]));
          ctx.lineTo(x, y1);
        } while (s < p);
        ctx.stroke();
        ctx.beginPath();
        ctx.fillStyle = "black";
        ctx.moveTo(xm - 5, hm);
        ctx.lineTo(xm, hm - 5);
        ctx.lineTo(xm + 5, hm);
        ctx.lineTo(xm - 5, hm);
        ctx.fill();

      }

      function clear_chart(c_num, p_data, range, max, p) {
        var ctx = chart[c_num];

        var x = 60;
        var y = 30;
        var w = 340;
        var h = 100;
        if (c_num === 0) {
          w = 740;
          h = 600;
        };
        var y_inc = h / range;

        var i = max;
        var s = 0;
        var y1 = 0;
        var xs = w / p;
        y1 = y + (y_inc * (i - p_data[0]));
        ctx.lineWidth = 2;
        ctx.strokeStyle = "white";
        ctx.beginPath();
        ctx.moveTo(x, y1);
        do {
          s++;
          x += xs;
          y1 = y + (y_inc * (i - p_data[s]));
          ctx.lineTo(x, y1);
        } while (s < p);
        ctx.stroke();
      }


      update_history = function() {
        var url1 = "https://script.google.com/macros/s/AKfycbzep_6TONHLbfjt1H23_iCb0DMc126LPo3smsun/exec?read=" + sel;
        xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function() {
          if (xhr.readyState == 4) {
            var t_r = xhr.responseText;
            var all_dat = t_r.split(",");
            var len = 24;
            var index = 0;
            var cell = 2;
            switch (sel) {
              case "hour":
                len = 59;
                do {
                  myarr[0][index] = all_dat[cell]; //in temp
                  myarr[1][index] = all_dat[cell + 18]; //out temp
                  myarr[2][index] = all_dat[cell + 3]; //out hum
                  myarr[3][index] = all_dat[cell + 21]; //in hum
                  myarr[4][index] = all_dat[cell + 24]; //pres
                  myarr[5][index] = all_dat[cell + 6]; //wind
                  myarr[6][index] = all_dat[cell + 9]; //gust
                  myarr[7][index] = all_dat[cell + 15] / 15; //rain
                  index++;
                  cell += 29;
                } while (index <= len);
                marker = all_dat[1770];
                if (parseFloat(all_dat[2 + (61 * 29)]) < parseFloat(all_dat[20 + (61 * 29)])) //temp low
                  m_m_arr[0][0] = Math.floor(all_dat[2 + (61 * 29)]) - 1;
                else
                  m_m_arr[0][0] = Math.floor(all_dat[20 + (61 * 29)]) - 1;

                if (parseFloat(all_dat[3 + (61 * 29)]) > parseFloat(all_dat[21 + (61 * 29)])) //temp high
                  m_m_arr[1][0] = Math.ceil(all_dat[3 + (61 * 29)]) + 1;
                else
                  m_m_arr[1][0] = Math.ceil(all_dat[21 + (61 * 29)]) + 1;

                m_m_arr[0][1] = m_m_arr[0][0];
                m_m_arr[1][1] = m_m_arr[1][0];

                if (parseFloat(all_dat[5 + (61 * 29)]) < parseFloat(all_dat[20 + (61 * 29)])) //hum low
                  m_m_arr[0][2] = Math.floor(all_dat[5 + (61 * 29)]) - 1;
                else
                  m_m_arr[0][2] = Math.floor(all_dat[20 + (61 * 29)]) - 1;

                if (parseFloat(all_dat[6 + (61 * 29)]) > parseFloat(all_dat[24 + (61 * 29)])) //hum high
                  m_m_arr[1][2] = Math.ceil(all_dat[6 + (61 * 29)]) + 1;
                else
                  m_m_arr[1][2] = Math.ceil(all_dat[24 + (61 * 29)]) + 1;

                m_m_arr[0][3] = m_m_arr[0][2];
                m_m_arr[1][3] = m_m_arr[1][2];

                m_m_arr[0][4] = Math.floor(all_dat[26 + (61 * 29)]) - 1; // pes low
                m_m_arr[1][4] = Math.ceil(all_dat[27 + (61 * 29)]) + 1; // pres high                

                m_m_arr[0][5] = 0; //wind low

                if (parseFloat(all_dat[12 + (61 * 29)]) > parseFloat(all_dat[15 + (61 * 29)])) //wind high
                  m_m_arr[1][5] = Math.ceil(all_dat[12 + (61 * 29)]) + 1;
                else
                  m_m_arr[1][5] = Math.ceil(all_dat[15 + (61 * 29)]) + 1;
                if (m_m_arr[1][5] < 2) m_m_arr[1][5] = 2;

                m_m_arr[0][6] = m_m_arr[0][5];
                m_m_arr[1][6] = m_m_arr[1][5];

                m_m_arr[0][7] = 0; //rain
                m_m_arr[1][7] = Math.ceil(all_dat[17 + (62 * 29)] / 15) + 1;
                break;
              case "day":
                len = 24;
                do {
                  myarr[0][index] = all_dat[cell]; //in temp
                  myarr[1][index] = all_dat[cell + 18]; //out temp
                  myarr[2][index] = all_dat[cell + 3]; //out hum
                  myarr[3][index] = all_dat[cell + 21]; //in hum
                  myarr[4][index] = all_dat[cell + 24]; //pres
                  myarr[5][index] = all_dat[cell + 6]; //wind
                  myarr[6][index] = all_dat[cell + 9]; //gust
                  myarr[7][index] = all_dat[cell + 15] / 15; //rain
                  index++;
                  cell += 29;
                } while (index <= len);
                marker = all_dat[784];
                if (parseFloat(all_dat[2 + (27 * 29)]) < parseFloat(all_dat[20 + (27 * 29)])) //temp low
                  m_m_arr[0][0] = Math.floor(all_dat[2 + (27 * 29)]) - 1;
                else
                  m_m_arr[0][0] = Math.floor(all_dat[20 + (27 * 29)]) - 1;

                if (parseFloat(all_dat[3 + (27 * 29)]) > parseFloat(all_dat[21 + (27 * 29)])) //temp high
                  m_m_arr[1][0] = Math.ceil(all_dat[3 + (27 * 29)]) + 1;
                else
                  m_m_arr[1][0] = Math.ceil(all_dat[21 + (27 * 29)]) + 1;

                m_m_arr[0][1] = m_m_arr[0][0];
                m_m_arr[1][1] = m_m_arr[1][0];

                if (parseFloat(all_dat[5 + (27 * 29)]) < parseFloat(all_dat[20 + (27 * 29)])) //hum low
                  m_m_arr[0][2] = Math.floor(all_dat[5 + (27 * 29)]) - 1;
                else
                  m_m_arr[0][2] = Math.floor(all_dat[20 + (27 * 29)]) - 1;

                if (parseFloat(all_dat[6 + (27 * 29)]) > parseFloat(all_dat[24 + (27 * 29)])) //hum high
                  m_m_arr[1][2] = Math.ceil(all_dat[6 + (27 * 29)]) + 1;
                else
                  m_m_arr[1][2] = Math.ceil(all_dat[24 + (27 * 29)]) + 1;

                m_m_arr[0][3] = m_m_arr[0][2];
                m_m_arr[1][3] = m_m_arr[1][2];

                m_m_arr[0][4] = Math.floor(all_dat[26 + (27 * 29)]) - 1; // pes low
                m_m_arr[1][4] = Math.ceil(all_dat[27 + (27 * 29)]) + 1; // pres high                

                m_m_arr[0][5] = 0; //wind low

                if (parseFloat(all_dat[12 + (27 * 29)]) > parseFloat(all_dat[15 + (27 * 29)])) //wind high
                  m_m_arr[1][5] = Math.ceil(all_dat[12 + (27 * 29)]) + 1;
                else
                  m_m_arr[1][5] = Math.ceil(all_dat[15 + (27 * 29)]) + 1;
                if (m_m_arr[1][5] < 2) m_m_arr[1][5] = 2;

                m_m_arr[0][6] = m_m_arr[0][5];
                m_m_arr[1][6] = m_m_arr[1][5];

                m_m_arr[0][7] = 0; //rain
                m_m_arr[1][7] = Math.ceil(all_dat[17 + (28 * 29)] / 15) + 1;
                break;
              default:
                len = 31;
                do {
                  myarr[0][index] = all_dat[cell];
                  myarr[1][index] = all_dat[cell + 18];
                  index++;
                  cell += 29;
                } while (index < len);
                break;
            }
         
            build_history(1, len);
          }
        };
        xhr.open("GET", url1);
        xhr.send(null);
      }


      sort_update = function() {
        if (active_window == 0)
          update_fields();
        if (active_window == 1) {
          update_history();
        }
      }

      function make_array() {
        myarr = new Array();
        myarr.push([]);
        myarr.push([]);
        myarr.push([]);
        myarr.push([]);
        myarr.push([]);
        myarr.push([]);
        myarr.push([]);
        myarr.push([]);
        m_m_arr = new Array();
        m_m_arr.push([]);
        m_m_arr.push([]);
      }
      var myVar = setInterval(sort_update, 10000);
      active_window = 0;
      make_array();
      sort_update();
      build_history(0, 59);
    }
  </script>
  <div class="gwd-div-1w7a gwd-gen-19kmgwdanimation">
    <div class="menu ">
      <button class="gwd-button-39lq gwd-button-it82 gwd-gen-it1egwdanimation" id="Btn_4">About</button>
      <button class="gwd-button-39lq gwd-button-cx08 gwd-gen-9blwgwdanimation" id="Btn_3"></button>
      <button class="gwd-button-39lq gwd-button-k5iy gwd-gen-5uiygwdanimation" id="Btn_2">History</button>
      <button class="gwd-button-39lq gwd-button-11u5 gwd-gen-1ju9gwdanimation" id="Btn_1">Current</button>
    </div>
  </div>
  <div class="gwd-div-2qgl" id="Data">
    <div class="about">
      <div class="cent_c" id="cent_c">
        <canvas id="canvas" height="750" width="1000"></canvas>
      </div>
      <div class="cent" id="canvas_area_1" height="750" width="1300">
        <div>
          <label for="" duration="">History Duration</label>
          <select id="duration" height="50" width="100">
            <option value="hour">Hour</option>
            <option value="day">Day</option>
            <option value="Jan">January</option>
            <option value="Feb">Febuary</option>
          </select>
        </div>
        <div class="column">
          <div class="row">
            <canvas id="canvas_b" height="170" width="440"></canvas>
          </div>
          <div class="row">
            <canvas id="canvas_c" height="170" width="440"></canvas>
          </div>
          <div class="row">
            <canvas id="canvas_d" height="170" width="440"></canvas>
          </div>
          <div class="row">
            <canvas id="canvas_e" height="170" width="440"></canvas>
          </div>
        </div>
        <div class="column_1">
          <canvas id="canvas_a" height="680" width="820"></canvas>
        </div>
      </div>
    </div>
    <div class="about" id="about">
      <div class="cent">
        <h3>Weather Station Operation</h3>
        <h4>Temperature </h4>
        <p>Sensor AM2320</p>
        <h4>Humidity </h4>
        <p>Sensor AM2320</p>
        <p></p>
        <h4>Air Pressure</h4>
        <p>Sensor BMP180</p>
        <p></p>
        <h4>Rain Fall</h4>
        <p>Count number of drips from calibrated Tube</p>
        <p></p>
        <h4>Wind Speed and Direction</h4>
        <p>Utrasonic Sensors @ N, S, E &amp; W</p>
        <p>Pulse Sensors N-S, S-N</p>
        <p>Measure Time of Flight each way to calculte N-S vector</p>
        <p>Pulse Sensors E-W, W-E</p>
        <p>Measure Time of Flight each way to calculte E-W vector</p>
        <p>Calculate Speed of Sound using Temperature and Humidity</p>
        <p>From above calculate Wind Speed and Bearing using Trig</p>
      </div>
    </div>
  </div>
  <label class="gwd-label-p0hn"></label>
</body>

</html>